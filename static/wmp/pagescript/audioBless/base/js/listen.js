;/*!src/listen/main.js*/
Vue.use(VueResource),Vue.http.options.emulateJSON=!0,Vue.use(infiniteScroll);var recordComponent=Vue.extend({template:"#record-btn-temp",data:function(){return{holddown:!1,uploadVoice:!1,uploading:!1,playing:!1,localId:0,serverId:0}},watch:{hasVoice:function(){this.$emit("showshare",this.hasVoice)},ready:function(){this.ready&&this.initAudioId&&""!=this.initAudioId&&(this.serverId=this.initAudioId,this.downloadVoice(this.serverId))},holddown:function(){this.$emit("pull",this.holddown,this.localId)}},computed:{hasVoice:function(){return 0!==this.localId}},props:["initAudioId","ready"],methods:{keydown:function(){this.holddown=!0},keyup:function(){this.holddown=!1},reset:function(){this.localId=0,this.serverId=0},playVoice:function(){if(this.hasVoice&&!this.holddown){this.keydown(),wx.playVoice({localId:this.localId});var t=this;wx.onVoicePlayEnd({success:function(){setTimeout(function(){t.keyup()},100)}})}},startRecord:function(){this.keydown(),wx.startRecord()},pushData:function(){this.$emit("pushdata",this.serverId)},downloadVoice:function(t){var o=this;wx.downloadVoice({serverId:t,success:function(t){o.localId=t.localId}})},uploaVoice:function(){var t=this;t.uploading=!0,wx.uploadVoice({localId:t.localId,isShowProgressTips:1,success:function(o){t.serverId=o.serverId,t.pushData()}})},stopRecord:function(){this.keyup();var t=this;wx.stopRecord({success:function(o){t.localId=o.localId,t.uploaVoice()}})}},directives:{play:{update:function(t,o){function n(){var o=t.children[1],n=t.children[2];o.style.opacity=0,n.style.opacity=0;var e=t.children,i=0,s=!1;window.playingAnimate=setInterval(function(){s?e[--i].style.opacity=0:e[i++].style.opacity=1,(i===e.length||0===i)&&(s=!s)},200)}function e(){window.clearInterval(window.playingAnimate);for(var o=0;o<t.children.length;o++)t.children[o].style.opacity=1}o.value?n():e()}}},mounted:function(){}});Vue.component("record-btn",recordComponent);var jdListComponent=Vue.extend({template:"#jd-list-temp",data:function(){return{commentList:[],busy:!1,hasMore:!0,totalCount:0,pageNo:1,userCount:0}},methods:{close:function(){this.$emit("closelist")},linkView:function(t,o){return t?"/wmp/user/"+appConfigId+"/audiobless/view/"+o:"javascript:;"},fetchData:function(){if(this.hasMore){var t=this;t.busy=!0,Vue.http.get("/wmp/user/"+appConfigId+"/audiobless/loadEgg?page="+this.pageNo+"&openId="+openId).then(function(o){var n=JSON.parse(o.body);return-1===n.code?void alert(n.msg):(t.commentList=[].concat(t.commentList,n.data.list),t.totalCount=n.data.userCount,t.pageNo=n.data.page+1,t.hasMore=n.data.haveMore,t.busy=!1,void console.log("list fetchData over"))})}}},created:function(){this.fetchData()}});Vue.component("jd-list",jdListComponent);var addjdComponent=Vue.extend({template:"#addjd-temp",data:function(){return{runing:!1}},methods:{touchHandler:function(){this.runing||(this.runing=!0,this.$emit("touchhandler"))},runOver:function(){this.runing=!1}}});Vue.component("addjd-btn",addjdComponent);var maskComponent=Vue.extend({template:"#mask-temp",data:function(){return{"switch":!1}},methods:{closelist:function(){console.log("closelist"),this.$emit("close")}}});Vue.component("mask-view",maskComponent);var app=new Vue({el:".container",data:{jjTypeChanging:!1,recorded:!1,initAudioId:0,share:!1,showMask:!1,alljdCount:alljdCount?alljdCount:0,myjdCount:myjdCount?myjdCount:0,maskSlotList:{list:"jd-list"},maskSlotName:"",initAudioId:initAudioId?initAudioId:0,wxReady:!1,holddown:!1,localId:0},methods:{addjdBothCount:function(){console.log("addjd count"),this.alljdCount++,this.myjdCount++,this.pushData()},showList:function(){0!==this.myjdCount&&(this.maskSlotName=this.maskSlotList.list,this.toggleShowMask())},toggleShowMask:function(){this.showMask=!this.showMask},pushData:function(){var t={openId:openId};Vue.http.post("/wmp/user/"+appConfigId+"/audiobless/sendEgg",t).then(function(t){t.body})},pullData:function(t,o){this.holddown=t,this.localId=o},redirectHref:function(t){var o=this;this.holddown?wx.stopVoice({localId:o.localId,success:function(){window.location.href=t}}):window.location.href=t}},mounted:function(){}});